# 🔍 DSD Breaker DART 감사보고서 검증 도구

> 원본 Excel Add-in 기능을 충실히 재현한 DART 감사보고서 자동 검증 시스템

## 📋 개요

DSD Breaker DART 감사보고서 검증 도구는 한국의 DART(Data Analysis, Retrieval and Transfer) 시스템에서 다운로드한 감사보고서의 **자동 검증**을 수행하는 Python 기반 도구입니다.

### ⚡ 핵심 기능 (원본 Excel Add-in 기반)

이 도구는 [원본 블로그 설명서](https://blog.naver.com/PostView.naver?blogId=lastingchild&logNo=220640584251)에 기반하여 개발되었습니다.

## ✨ 주요 검증 기능

### 🔍 1. HTML 테이블 자동 추출
- DART HTML 파일에서 재무제표 테이블 자동 파싱
- BeautifulSoup을 이용한 정확한 HTML 구조 분석
- pandas DataFrame으로 즉시 변환

### 📊 2. 재무제표 레벨 자동 감지
- **들여쓰기 기반 계층 구조 자동 인식**
- 항목별 레벨(Level) 자동 분류
- 레벨별 합계 분석 및 검증

### ➕ 3. 합계 검증 시스템
- **보고된 합계 vs 계산된 합계 자동 비교**
- '합계', '총계', 'Total' 키워드 자동 인식
- 불일치 항목 자동 탐지 및 리포트

### 🔄 4. 교차 참조 확인
- **여러 테이블 간 동일 항목 값 비교**
- 재무제표와 주석 간 일관성 검증
- 공통 항목 자동 매칭 및 차이점 분석

### ⚠️ 5. 오류 패턴 자동 탐지
- 비정상적인 음수/양수 패턴 감지
- 중복 항목 자동 확인
- 빈 셀 비율 분석
- 데이터 품질 검사

## 🚀 설치 및 실행

### 1. 의존성 설치
```bash
pip install pandas numpy openpyxl beautifulsoup4 lxml html5lib matplotlib
```

### 2. 감사보고서 검증 도구 실행
```bash
python3 dsd_breaker_audit.py
```

## 📁 지원 파일 형식

### 입력 파일
- ✅ **DART HTML 파일** (.html, .htm) - 권장
- ✅ **Excel 파일** (.xlsx, .xls)

### 출력 파일
- ✅ **Excel 검증 리포트** (.xlsx)
- ✅ **텍스트 리포트** (.txt)

## 🔧 사용 방법

### 1단계: 파일 열기
1. **"HTML 파일 열기"** - DART에서 다운로드한 감사보고서
2. **"Excel 파일 열기"** - 재무제표가 포함된 Excel 파일

### 2단계: 자동 검증 실행
- **"전체 검증 실행"** - 모든 검증을 순차적으로 수행
- 또는 개별 검증 기능 선택:
  - 🔍 테이블 추출
  - 📊 레벨 자동 감지  
  - ➕ 합계 검증
  - 🔄 교차 참조 확인
  - ⚠️ 오류 탐지

### 3단계: 결과 확인
- **처리 로그**: 실시간 검증 과정 확인
- **추출된 테이블**: 파싱된 재무 데이터 미리보기
- **검증 결과**: 최종 검증 리포트 및 발견된 문제점

## 📊 검증 예시

### 합계 검증 결과
```
✅ 자산총계: 합계 일치 (1,234,567,890)
❌ 합계 불일치: 부채총계, 계산값 987,654,321 ≠ 보고값 987,654,320
✅ 자본총계: 합계 일치 (246,913,569)
```

### 교차 참조 확인 결과
```
🔍 재무상태표 ↔ 주석 비교:
  ✅ 현금및현금성자산: 1,000,000 (일치)
  ❌ 매출채권: 재무상태표=500,000 ≠ 주석=500,001
```

### 레벨 분석 결과
```
📈 감지된 레벨: {0: 5개, 1: 12개, 2: 18개}
  Level 0 (자산): 3개 항목, 합계 1,234,567,890
  Level 1 (유동자산): 8개 항목, 합계 800,000,000
  Level 2 (현금및현금성자산): 2개 항목, 합계 100,000,000
```

## ⚠️ 중요 사항

### 자동 검증의 한계
> **주의**: 이 도구는 보조 도구이며, **반드시 수동 확인이 필요**합니다.

- 복잡한 재무제표 구조는 별도 검토 권장
- 특수한 회계 처리는 수동 검증 필수
- 자동 검증 결과는 **참고용**으로 활용

### 권장 검증 절차
1. DSD Breaker로 1차 자동 검증
2. 발견된 오류 항목 수동 확인
3. 원본 DART 문서와 교차 확인
4. 최종 감사 의견 작성

## 🆚 원본 Excel Add-in과의 차이점

| 기능 | Excel Add-in | Python Edition |
|------|-------------|----------------|
| 플랫폼 | Windows Excel 전용 | 크로스 플랫폼 |
| HTML 파싱 | 제한적 | 고도화된 HTML 파싱 |
| 레벨 감지 | 수동/반자동 | 완전 자동화 |
| 검증 리포트 | 기본 | 상세 분석 리포트 |
| 교차 참조 | 기본 | 지능형 매칭 |
| 확장성 | 제한적 | 오픈소스, 확장 가능 |

## 🔍 기술적 특징

### HTML 파싱 엔진
- **BeautifulSoup4**: 강력한 HTML 구조 분석
- **pandas.read_html()**: 테이블 자동 변환
- **정규식 기반**: 한국어 키워드 정확 인식

### 레벨 감지 알고리즘
```python
# 들여쓰기 기반 레벨 계산
leading_spaces = len(value) - len(value.lstrip())
level = leading_spaces // 2  # 2칸 단위 레벨
```

### 합계 검증 로직
```python
# 키워드 기반 합계 행 자동 탐지
sum_keywords = ['합계', '총계', 'Total', '계', 'Sum']
# 계산값과 보고값 정밀 비교 (0.01 오차 허용)
```

## 📈 향후 개발 계획

- [ ] **XBRL 연동**: 직접 XBRL 파일 검증
- [ ] **AI 기반 이상 탐지**: 머신러닝 오류 패턴 학습
- [ ] **웹 인터페이스**: 브라우저 기반 사용 환경
- [ ] **API 연동**: DART API 직접 연결
- [ ] **자동 보고서**: PDF 검증 리포트 자동 생성

## 🤝 기여하기

이 프로젝트는 한국의 감사 실무진들의 업무 효율성 향상을 목표로 합니다.

### 기여 방법
1. 실제 DART 보고서로 테스트
2. 오류 패턴 추가 제안
3. 검증 로직 개선 아이디어
4. 사용성 개선 제안

## 📞 지원 및 문의

- **이슈 리포팅**: GitHub Issues
- **기능 제안**: Pull Request
- **사용법 문의**: README 참조

---

**개발 기반**: [원본 DSD Breaker 설명서](https://blog.naver.com/PostView.naver?blogId=lastingchild&logNo=220640584251)  
**개발일**: 2025년 6월 23일  
**버전**: 2.0.0 (DART 특화)  
**상태**: ✅ 완성

> 💡 **Tip**: 처음 사용하시는 경우 작은 규모의 감사보고서로 테스트해보신 후 본격적으로 활용하시기 바랍니다.