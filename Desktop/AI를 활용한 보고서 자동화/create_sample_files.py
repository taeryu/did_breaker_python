import pandas as pd
from openpyxl import Workbook
from openpyxl.styles import Font, PatternFill, Alignment

def create_sample_mapping_file():
    """계정과목매핑표 샘플 파일 생성"""
    
    # 샘플 매핑 데이터
    mapping_data = [
        ["1100", "현금및현금성자산", "현금및현금성자산", "자산", "BS", "유동자산"],
        ["1200", "단기금융상품", "단기금융상품", "자산", "BS", "유동자산"],
        ["1310", "매출채권", "매출채권", "자산", "BS", "유동자산"],
        ["1400", "재고자산", "재고자산", "자산", "BS", "유동자산"],
        ["1510", "유형자산", "유형자산", "자산", "BS", "비유동자산"],
        ["2100", "매입채무", "매입채무", "부채", "BS", "유동부채"],
        ["2200", "단기차입금", "단기차입금", "부채", "BS", "유동부채"],
        ["2500", "장기차입금", "장기차입금", "부채", "BS", "비유동부채"],
        ["3100", "자본금", "자본금", "자본", "BS", "자본"],
        ["3200", "이익잉여금", "이익잉여금", "자본", "BS", "자본"],
        ["4100", "매출액", "매출액", "수익", "IS", "매출"],
        ["5100", "매출원가", "매출원가", "비용", "IS", "매출원가"],
        ["6100", "급여", "급여", "비용", "IS", "판관비"],
        ["6200", "상여금", "상여금", "비용", "IS", "판관비"],
        ["6300", "감가상각비", "감가상각비", "비용", "IS", "판관비"],
        ["7100", "이자수익", "이자수익", "수익", "IS", "영업외수익"],
        ["8100", "이자비용", "이자비용", "비용", "IS", "영업외비용"]
    ]
    
    columns = ["계정코드", "계정명", "보고서계정명", "계정구분", "재무제표구분", "대분류"]
    df = pd.DataFrame(mapping_data, columns=columns)
    
    df.to_excel("계정과목매핑표.xlsx", index=False)
    print("✅ 계정과목매핑표.xlsx 생성 완료")

def create_sample_trial_balance():
    """시산표 샘플 파일 생성"""
    
    # 샘플 시산표 데이터
    trial_data = [
        ["1100", "현금및현금성자산", 50000000, 0, 50000000],
        ["1200", "단기금융상품", 30000000, 0, 30000000],
        ["1310", "매출채권", 100000000, 0, 100000000],
        ["1400", "재고자산", 80000000, 0, 80000000],
        ["1510", "유형자산", 200000000, 0, 200000000],
        ["2100", "매입채무", 0, 40000000, -40000000],
        ["2200", "단기차입금", 0, 60000000, -60000000],
        ["2500", "장기차입금", 0, 100000000, -100000000],
        ["3100", "자본금", 0, 50000000, -50000000],
        ["3200", "이익잉여금", 0, 150000000, -150000000],
        ["4100", "매출액", 0, 500000000, -500000000],
        ["5100", "매출원가", 300000000, 0, 300000000],
        ["6100", "급여", 80000000, 0, 80000000],
        ["6200", "상여금", 20000000, 0, 20000000],
        ["6300", "감가상각비", 15000000, 0, 15000000],
        ["7100", "이자수익", 0, 5000000, -5000000],
        ["8100", "이자비용", 8000000, 0, 8000000]
    ]
    
    columns = ["G/L Account", "Account Name", "Debit", "Credit", "Balance"]
    df = pd.DataFrame(trial_data, columns=columns)
    
    df.to_excel("시산표샘플.xlsx", index=False)
    print("✅ 시산표샘플.xlsx 생성 완료")

def create_sample_template():
    """경영실적요약 템플릿 샘플 파일 생성"""
    
    wb = Workbook()
    ws = wb.active
    ws.title = "경영실적요약"
    
    # 헤더 및 구조 생성
    ws['A1'] = "2024년 11월 경영실적요약"
    ws['A1'].font = Font(size=16, bold=True)
    
    # 손익계산서 구조
    ws['A3'] = "손익계산서"
    ws['A3'].font = Font(size=14, bold=True)
    
    ws['A5'] = "매출액"
    ws['A6'] = "매출원가" 
    ws['A7'] = "매출총이익"
    ws['A8'] = "판매비와관리비"
    ws['A9'] = "영업이익"
    ws['A10'] = "영업외수익"
    ws['A11'] = "영업외비용"
    ws['A12'] = "법인세비용차감전순이익"
    
    # 컬럼 헤더
    ws['B4'] = "당월"
    ws['C4'] = "전년동월"
    
    wb.save("경영실적요약템플릿.xlsx")
    print("✅ 경영실적요약템플릿.xlsx 생성 완료")

def create_sample_bs_template():
    """재무상태표 템플릿 샘플 파일 생성"""
    
    wb = Workbook()
    ws = wb.active
    ws.title = "재무상태표"
    
    # 헤더
    ws['A1'] = "2024년 11월말 재무상태표"
    ws['A1'].font = Font(size=16, bold=True)
    
    # 자산 부분
    ws['A3'] = "자산"
    ws['A3'].font = Font(size=14, bold=True)
    
    ws['A5'] = "현금및현금성자산"
    ws['A6'] = "단기금융상품"
    ws['A7'] = "매출채권"
    ws['A8'] = "기타채권"
    ws['A9'] = "재고자산"
    ws['A10'] = "선급금"
    ws['A11'] = "선급비용"
    
    ws['A15'] = "장기금융상품"
    ws['A16'] = "투자자산"
    ws['A17'] = "유형자산"
    ws['A18'] = "무형자산"
    ws['A19'] = "기타비유동자산"
    
    # 부채 부분
    ws['C3'] = "부채"
    ws['C3'].font = Font(size=14, bold=True)
    
    ws['C5'] = "매입채무"
    ws['C6'] = "기타채무"
    ws['C7'] = "단기차입금"
    ws['C8'] = "미지급금"
    ws['C9'] = "미지급비용"
    ws['C10'] = "선수금"
    ws['C11'] = "예수금"
    
    ws['C15'] = "장기차입금"
    ws['C16'] = "퇴직급여충당부채"
    ws['C17'] = "기타비유동부채"
    
    # 자본 부분
    ws['C21'] = "자본금"
    ws['C22'] = "자본잉여금"
    ws['C23'] = "이익잉여금"
    ws['C24'] = "기타포괄손익누계액"
    
    wb.save("재무상태표템플릿.xlsx")
    print("✅ 재무상태표템플릿.xlsx 생성 완료")

if __name__ == "__main__":
    print("🔧 샘플 파일들 생성 중...")
    create_sample_mapping_file()
    create_sample_trial_balance()
    create_sample_template()
    create_sample_bs_template()
    print("🎉 모든 샘플 파일 생성 완료!")