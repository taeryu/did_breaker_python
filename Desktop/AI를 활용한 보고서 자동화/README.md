# SAP 월마감 자동화 시스템

Excel 템플릿 기반 결산보고서 자동 생성 시스템입니다.

## 🚀 주요 기능

- **SAP 시산표 데이터 자동 처리**
- **계정과목 매핑 및 집계**
- **Excel 템플릿 기반 보고서 생성**
- **다양한 재무제표 형식 지원**

## 📋 필요한 파일들

### 1. 설정 파일
- `계정과목매핑표.xlsx`: SAP 계정코드와 보고서 계정명 매핑
- `셀매핑.xlsx`: Excel 템플릿의 셀 위치 매핑 정보
- `column_mapping.csv`: SAP 컬럼명 → 한글 컬럼명 변환

### 2. 데이터 파일
- SAP 시산표 Excel 파일 (G/L Account, Balance 등 포함)

### 3. 템플릿 파일
- 경영실적요약.xlsx
- 재무상태표.xlsx
- 기타 원하는 보고서 템플릿

## 🔧 사용 방법

### 1. 메인 시스템 실행
```bash
python3 "Excel 템플릿 기반 결산보고서 생성 시스템.py"
```

### 2. 샘플 파일 생성 (테스트용)
```bash
python3 create_sample_files.py
python3 "엑셀 템플릿 셀 별 매핑파일 생성.py"
```

### 3. 시스템 테스트
```bash
python3 full_system_test.py
```

## 📊 파일 구조

```
├── Excel 템플릿 기반 결산보고서 생성 시스템.py  # 메인 시스템
├── 엑셀 템플릿 셀 별 매핑파일 생성.py            # 셀매핑 파일 생성기
├── create_sample_files.py                      # 샘플 데이터 생성기
├── column_mapping.csv                          # 컬럼명 매핑 설정
├── 계정과목매핑표.xlsx                         # 계정 매핑 테이블
├── 셀매핑.xlsx                                 # 셀 위치 매핑
├── 시산표샘플.xlsx                             # 샘플 시산표
├── 경영실적요약.xlsx                           # 손익계산서 템플릿
└── 재무상태표.xlsx                             # 재무상태표 템플릿
```

## ⚙️ 설정 방법

### 1. 계정과목매핑표.xlsx
| 계정코드 | 계정명 | 보고서계정명 | 재무제표구분 | 대분류 |
|---------|--------|-------------|-------------|--------|
| 1100 | 현금및현금성자산 | 현금및현금성자산 | BS | 유동자산 |
| 4100 | 매출액 | 매출액 | IS | 매출 |

### 2. 셀매핑.xlsx
| 파일명 | 섹션 | 계정명 | 셀주소 | 데이터소스 |
|-------|------|--------|---------|-----------|
| 경영실적요약 | 당월데이터 | 매출액 | B5 | IS |
| 재무상태표 | 유동자산 | 현금및현금성자산 | B5 | BS |

## 🎯 특징

- **GUI 파일 선택**: tkinter 기반 사용자 친화적 인터페이스
- **오류 처리**: 포괄적인 예외 처리 및 로깅
- **데이터 검증**: 매핑되지 않은 계정 자동 감지
- **유연한 설정**: CSV 기반 컬럼 매핑으로 쉬운 커스터마이징

## 📝 요구사항

- Python 3.x
- pandas
- openpyxl
- tkinter (GUI)

## 🐛 문제 해결

### 일반적인 오류들
1. **KeyError: '파일명'** → 셀매핑.xlsx의 컬럼명 확인
2. **매핑되지 않은 계정** → 계정과목매핑표.xlsx에 계정 추가
3. **셀 주소 오류** → Excel 템플릿과 셀매핑.xlsx 일치 확인

## 📈 개발 히스토리

- 초기 개발: Claude AI 기반 자동 생성
- 디버깅: 컬럼명 불일치, 파일명 매칭 문제 해결
- 테스트: 샘플 데이터 기반 검증 완료

## 🤝 기여

이슈나 개선사항이 있으시면 GitHub Issues를 통해 알려주세요!